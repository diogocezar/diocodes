generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mongodb"
    url      = env("URI_MONGODB")
}

enum Role {
    ADMIN
    USER
}

model Person {
    id                String     @id @default(uuid()) @map("_id")
    name              String
    email             String     @unique
    user              User?
    mentoringHost     Mentoring? @relation(name: "mentoring_host")
    mentoringAttendee Mentoring? @relation(name: "mentoring_atendee")
    createdAt         DateTime   @default(now())
    updatedAt         DateTime?
    removedAt         DateTime?
}

model User {
    id        String    @id @default(uuid()) @map("_id")
    person    Person    @relation(fields: [personId], references: [id])
    personId  String    @unique
    role      Role      @default(USER)
    createdAt DateTime  @default(now())
    updatedAt DateTime?
    removedAt DateTime?
}

model Tag {
    id             String           @id @default(uuid()) @map("_id")
    name           String
    createdAt      DateTime         @default(now())
    updatedAt      DateTime?
    removedAt      DateTime?
    AvaliationTags AvaliationTags[]
}

model AvaliationTags {
    id           String      @id @default(uuid()) @map("_id")
    avaliation   Avaliation? @relation(fields: [avaliationId], references: [id])
    avaliationId String?
    tag          Tag?        @relation(fields: [tagId], references: [id])
    tagId        String?
    createdAt    DateTime    @default(now())
    updatedAt    DateTime?
    removedAt    DateTime?
}

model Avaliation {
    id             String           @id @default(uuid()) @map("_id")
    mentoring      Mentoring        @relation(fields: [mentoringId], references: [id])
    mentoringId    String           @unique
    rating         Int
    AvaliationTags AvaliationTags[]
    comment        String?
    wasSent        Boolean          @default(false)
    createdAt      DateTime         @default(now())
    updatedAt      DateTime?
    removedAt      DateTime?
}

model Mentoring {
    id         String      @id @default(uuid()) @map("_id")
    host       Person      @relation(name: "mentoring_host", fields: [hostId], references: [id])
    hostId     String      @unique
    attendee   Person      @relation(name: "mentoring_atendee", fields: [attendeeId], references: [id])
    attendeeId String      @unique
    startTime  DateTime
    endTime    DateTime
    avaliation Avaliation?
    createdAt  DateTime    @default(now())
    updatedAt  DateTime?
    removedAt  DateTime?
}
